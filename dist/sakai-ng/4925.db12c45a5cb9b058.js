"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[4925],{4925:(H,u,o)=>{o.r(u),o.d(u,{TransListModule:()=>Y});var g=o(6814),m=o(2549),d=o(5219),e=o(9467),h=o(6739),y=o(5132),F=o(615),x=o(9485),c=o(9552),f=o(707),T=o(4480),v=o(3530),M=o(8831),r=o(95),_=o(1230),C=o(4104),Z=o(3714),A=o(3722),b=o(3965);function L(s,p){1&s&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"ID"),e.qZA(),e.TgZ(3,"th",29),e._uU(4,"Transcription Name "),e._UZ(5,"p-sortIcon",30),e.qZA(),e.TgZ(6,"th",31),e._uU(7,"File "),e._UZ(8,"p-sortIcon",32),e.qZA(),e.TgZ(9,"th",33),e._uU(10,"Uploaded At "),e._UZ(11,"p-sortIcon",34),e.qZA(),e.TgZ(12,"th",35),e._uU(13,"Transcript"),e._UZ(14,"p-sortIcon",36),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Action"),e.qZA()())}function N(s,p){if(1&s){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"slice"),e.qZA(),e.TgZ(12,"td")(13,"div",37)(14,"button",38),e.NdJ("click",function(){const l=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.playAudio(a.audioFile,l))}),e.qZA(),e.TgZ(15,"button",39),e.NdJ("click",function(){const l=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.deleteTranscription(l.trans_filename,l.uploaded_at))}),e.qZA()()()()}if(2&s){const t=p.$implicit,i=e.oxw();e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(t.trans_filename),e.xp6(2),e.Oqu(i.extractFileName(t.filename)),e.xp6(2),e.Oqu(t.uploaded_at),e.xp6(2),e.Oqu(e.Dn7(11,5,t.transcript,0,200))}}function S(s,p){if(1&s){const t=e.EpF();e.TgZ(0,"div",40)(1,"label",41),e._uU(2,"File Name"),e.qZA(),e.TgZ(3,"input",42),e.NdJ("ngModelChange",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedAudioFile.file=n)}),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("ngModel",t.selectedAudioFile.file)}}function U(s,p){if(1&s){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.hideEditDialog())}),e.qZA(),e.TgZ(1,"button",44),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.saveAudioFile())}),e.qZA()}}function w(s,p){if(1&s&&(e._UZ(0,"app-audio-player",45),e.TgZ(1,"div",2)(2,"p-panel",46)(3,"p"),e._uU(4),e.qZA()()()),2&s){const t=e.oxw();e.Q6J("audioUrl",t.getAudioUrl()),e.xp6(2),e.Q6J("toggleable",!0),e.xp6(2),e.Oqu(t.getCurrentTrans())}}function D(s,p){if(1&s){const t=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.hidePlayDialog())}),e.qZA()}}const J=()=>[10,20,30],k=()=>({width:"450px"}),q=()=>({width:"80vh","max-height":"80vh"});let E=(()=>{class s{constructor(t,i,n,l,a){this.userFileService=t,this.transcriptionService=i,this.taskService=n,this.service=l,this.uploadService=a,this.audioFiles=[],this.filteredAudioFiles=[],this.transData=[],this.filteredTransData=[],this.editDialogVisible=!1,this.playDialogVisible=!1,this.selectedAudioFileName="",this.transcriptionName="",this.items=[],this.cardMenu=[],this.msgs=[],this.uploadedFiles=[],this.uploadSuccess=!1,this.languageOptions=["pl","en"],this.selectedTranscription=""}ngOnInit(){this.fetchAudioFiles(),this.fetchTranscriptions(),this.items=[{label:"Angular.io",icon:"pi pi-external-link",url:"http://angular.io"},{label:"Theming",icon:"pi pi-bookmark",routerLink:["/theming"]}],this.cardMenu=[{label:"Save",icon:"pi pi-fw pi-check"},{label:"Update",icon:"pi pi-fw pi-refresh"},{label:"Delete",icon:"pi pi-fw pi-trash"}]}fetchAudioFiles(){this.userFileService.getFileList().subscribe(t=>{this.audioFiles=t.map(i=>this.extractFileName(i.file)),this.filteredAudioFiles=t},t=>{console.error("Error fetching audio files:",t)})}fetchTranscriptions(){this.transcriptionService.getTranscriptionList().subscribe(t=>{this.transData=t,this.filteredTransData=t},t=>{console.error("Error fetching audio files:",t)})}extractFileName(t){const i=t.split("/");return i[i.length-1]}onGlobalFilter(t){t=t.trim().toLowerCase(),this.filteredTransData=this.transData.filter(i=>i.id.toString().toLowerCase().includes(t)||i.user.toLowerCase().includes(t)||i.filename.toLowerCase().includes(t)||i.uploaded_at.toLowerCase().includes(t)||i.trans_filename.toLowerCase().includes(t)||i.transcript.toLowerCase().includes(t))}deleteTranscription(t,i){this.transcriptionService.deleteTranscriptionByName(t,i).subscribe(()=>{this.transData=this.transData.filter(n=>n.uploaded_at!==i),this.filteredTransData=this.filteredTransData.filter(n=>n.uploaded_at!==i),this.showWarnViaToast()},n=>{console.error("Error deleting audio file:",n)})}playAudio(t,i){this.selectedAudioFile=t,this.playDialogVisible=!0,this.selectedTranscription=i}hidePlayDialog(){this.playDialogVisible=!1}editAudioFile(t){this.selectedAudioFile=t,this.editDialogVisible=!0}hideEditDialog(){this.editDialogVisible=!1}generateTranscription(t){this.selectedAudioFileName&&t?(console.error("1"),console.error(this.selectedAudioFileName),this.showInfoViaToast(),this.transcriptionService.generateTranscription(this.selectedAudioFileName,t,this.selectedLanguage).subscribe(i=>{console.log("Transcription generated successfully:",i),this.taskService.setTaskId(i.task_id),console.log(this.taskService.taskId),this.taskService.pollTaskStatus().subscribe(n=>{console.log("Task status response:",n),"completed"==n.status&&(console.log("Loading message popup..."),this.showSuccessViaToast(),this.fetchTranscriptions())},n=>{console.error("Error polling task status:",n)})},i=>{console.error("Error generating transcription:",i)})):(console.error("No audio file selected or transcription name is empty"),this.showErrorViaToast())}getAudioUrl(){return this.selectedTranscription.filename}getCurrentTrans(){return this.selectedTranscription.transcript}showInfoViaToast(){this.service.add({key:"tst",severity:"info",summary:"Info Message",detail:"Your transrciption is being processed...",life:6500})}showErrorViaToast(){this.service.add({key:"tst",severity:"error",summary:"Error Message",detail:"No audio file selected or transcription name is empty",life:6500})}showSuccessViaToast(){this.service.add({key:"tst",severity:"success",summary:"Success Message",detail:"Your transcription is ready!",life:6500})}showSuccessViaToastUpload(){this.service.add({key:"tst",severity:"success",summary:"Success Message",detail:"Your file has been succesfully added",life:6500})}showWarnViaToast(){this.service.add({key:"tst",severity:"warn",summary:"Warn Message",detail:"Succesfully deleted transcription"})}uploadFile(t){const i=t.files;this.uploadService.uploadFile(i[0]).subscribe(n=>{console.log("File uploaded successfully:",n),this.uploadedFiles.push(i[0]),this.uploadSuccess=!0,this.fetchAudioFiles(),this.showSuccessViaToastUpload()},n=>{console.error("Error uploading file:",n),this.uploadSuccess=!1})}static#e=this.\u0275fac=function(i){return new(i||s)(e.Y36(h.B),e.Y36(y.J),e.Y36(F.M),e.Y36(d.ez),e.Y36(x.C))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-trans-list"]],features:[e._Bn([d.ez])],decls:43,vars:26,consts:[[1,"grid"],[1,"col-12"],[1,"card"],["name","demo[]","accept","audio/*","customUpload","true",3,"multiple","maxFileSize","uploadHandler"],[3,"ngSubmit"],["transcriptionForm","ngForm"],[1,"row"],[1,"col-12","mb-2","lg:col-4","lg:mb-0"],["name","selectedAudioFileName","placeholder","Select the audio file","ngModel","","required","",3,"options","ngModel","showClear","ngModelChange"],["selectedAudioModel","ngModel"],["name","selectedLanguage","placeholder","Select the language used in the audio","ngModel","","required","",3,"options","ngModel","showClear","ngModelChange"],["selectedLanguageModel","ngModel"],["type","text","pInputText","","placeholder","Name of the transcription","name","transcriptionName","required","",3,"ngModel","ngModelChange"],["transcriptionNameModel","ngModel"],["type","submit","pButton","","pRipple","",3,"disabled"],["key","tst"],[1,"card","px-6","py-6"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center","mb-4"],[1,"m-0"],[1,"flex","items-center"],[1,"pi","pi-search","mr-1"],["pInputText","","type","text","placeholder","Search...",1,"w-full","lg:w-96",3,"input"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rows","paginator","rowsPerPageOptions","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["header","Product Details",1,"p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Play Audio",1,"p-fluid",3,"visible","modal","visibleChange"],["pSortableColumn","trans_filename"],["field","Transcriptionname"],["pSortableColumn","filename"],["field","file"],["pSortableColumn","uploaded_at"],["field","uploaded_at"],["pSortableColumn","transcript"],["field","transcript"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-play",1,"p-button-rounded","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"click"],[1,"field"],["for","fileName"],["type","text","pInputText","","id","fileName","required","","autofocus","",3,"ngModel","ngModelChange"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-text",3,"click"],[3,"audioUrl"],["header","Transkrypcja",1,"line-height-3","m-0",3,"toggleable"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-text",3,"click"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),e._uU(4,"Upload a file for the transcription"),e.qZA(),e.TgZ(5,"p-fileUpload",3),e.NdJ("uploadHandler",function(a){return n.uploadFile(a)}),e.qZA()()()(),e.TgZ(6,"div",2)(7,"h5"),e._uU(8,"Generate transcription"),e.qZA(),e.TgZ(9,"form",4,5),e.NdJ("ngSubmit",function(){return n.generateTranscription(n.transcriptionName)}),e.TgZ(11,"div",6)(12,"div",7)(13,"p-dropdown",8,9),e.NdJ("ngModelChange",function(a){return n.selectedAudioFileName=a}),e.qZA()()(),e.TgZ(15,"div",6)(16,"div",7)(17,"p-dropdown",10,11),e.NdJ("ngModelChange",function(a){return n.selectedLanguage=a}),e.qZA()()(),e.TgZ(19,"div",7)(20,"input",12,13),e.NdJ("ngModelChange",function(a){return n.transcriptionName=a}),e.qZA()(),e.TgZ(22,"button",14),e._uU(23,"Generate"),e.qZA()()(),e._UZ(24,"p-toast",15),e.TgZ(25,"div",0)(26,"div",1)(27,"div",16)(28,"div",17)(29,"h5",18),e._uU(30,"User transcriptions"),e.qZA(),e.TgZ(31,"span",19),e._UZ(32,"i",20),e.TgZ(33,"input",21),e.NdJ("input",function(a){return n.onGlobalFilter(a.target.value)}),e.qZA()()(),e.TgZ(34,"p-table",22),e.YNc(35,L,17,0,"ng-template",23)(36,N,16,9,"ng-template",24),e.qZA(),e.TgZ(37,"p-dialog",25),e.NdJ("visibleChange",function(a){return n.editDialogVisible=a}),e.YNc(38,S,4,1,"ng-template",26)(39,U,2,0,"ng-template",27),e.qZA(),e.TgZ(40,"p-dialog",28),e.NdJ("visibleChange",function(a){return n.playDialogVisible=a}),e.YNc(41,w,5,3,"ng-template",26)(42,D,1,0,"ng-template",27),e.qZA()()()()),2&i){const l=e.MAs(10);e.xp6(5),e.Q6J("multiple",!1)("maxFileSize",1e9),e.xp6(8),e.Q6J("options",n.audioFiles)("ngModel",n.selectedAudioFileName)("showClear",!0),e.xp6(4),e.Q6J("options",n.languageOptions)("ngModel",n.selectedLanguage)("showClear",!0),e.xp6(3),e.Q6J("ngModel",n.transcriptionName),e.xp6(2),e.Q6J("disabled",!l.valid),e.xp6(12),e.Q6J("value",n.filteredTransData)("rows",10)("paginator",!0)("rowsPerPageOptions",e.DdM(23,J))("showCurrentPageReport",!0),e.xp6(3),e.Akn(e.DdM(24,k)),e.Q6J("visible",n.editDialogVisible)("modal",!0),e.xp6(3),e.Akn(e.DdM(25,q)),e.Q6J("visible",n.playDialogVisible)("modal",!0)}},dependencies:[c.iA,d.jx,c.lQ,c.fz,f.Hq,T.H,v.V,M.N,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.On,r.F,_.s,C.FN,Z.o,A.p,b.Lt,g.OU],encapsulation:2})}return s})(),O=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=e.oAB({type:s});static#i=this.\u0275inj=e.cJS({imports:[m.Bz.forChild([{path:"",component:E}]),m.Bz]})}return s})();var V=o(1782),B=o(1122),I=o(9502),Q=o(7161);let Y=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=e.oAB({type:s});static#i=this.\u0275inj=e.cJS({providers:[h.B,d.ez],imports:[g.ez,O,c.U$,f.hJ,T.T,v.S,V.w,r.u5,B.$9,_.Q,I.$,Q.O,C.EV,Z.j,A.O,b.kW]})}return s})()}}]);